# Настройка функционала сброса пароля

## Добавленные переменные окружения

Для работы функционала сброса пароля добавьте следующие переменные в ваш `.env` файл:

```env
# Email settings for password reset
YANDAX_EMAIL=your_email@yandex.ru
YANDEX_APP_PASS=your_app_password
SMTP_HOST=smtp.yandex.ru
SMTP_PORT=587
```

## Описание функционала

### Новый эндпоинт: POST /users/reset-password

Позволяет сбросить пароль пользователя по email.

**Запрос:**
```json
{
  "email": "user@example.com"
}
```

**Ответ при успехе:**
```json
{
  "message": "Новый пароль отправлен на email"
}
```

### Что происходит при сбросе пароля:

1. Система ищет пользователя по email
2. Генерируется новый пароль по паттерну из настроек
3. Пароль хешируется и сохраняется в БД
4. Версия токена увеличивается (все активные сессии завершаются)
5. Новый пароль отправляется на email пользователя

### Безопасность

- Все активные токены пользователя инвалидируются при сбросе пароля
- Пароль генерируется по строгому паттерну из настроек
- Email отправляется только если пользователь существует в БД
- В случае ошибки отправки email, пароль все равно меняется в БД

## Файлы, которые были изменены/добавлены:

- `app/core/config.py` - добавлены настройки email
- `app/api/utils.py` - новый файл с утилитами для email и генерации паролей
- `app/schemas/user.py` - добавлена схема UserResetPassword
- `app/crud/user.py` - добавлены методы get_by_email и reset_password
- `app/core/constants.py` - добавлены константы для нового эндпоинта
- `app/api/endpoints/user.py` - добавлен эндпоинт reset_password
